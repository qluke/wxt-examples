# Project Files Export

Export time: 2025/8/1 18:22:39

Source directory: `svelte-state-rune`

Output file: `project-files.md`

## Directory Structure

```
svelte-state-rune
├── .wxt
├── public
├── src
├── explain.md
├── index.html
├── package.json
├── README.md
├── tsconfig.json
├── wxt-env.d.ts
└── wxt.config.ts
```

## File Statistics

- Total files: 24
- Total size: 15.4 KB

### File Type Distribution

| Extension | Files | Total Size |
| --- | --- | --- |
| .ts | 15 | 10.9 KB |
| .json | 3 | 1.3 KB |
| .md | 2 | 857 bytes |
| .html | 2 | 865 bytes |
| .css | 1 | 870 bytes |
| .svelte | 1 | 637 bytes |

## File Contents

### .wxt\tsconfig.json

```json
// .wxt\tsconfig.json
{
  "compilerOptions": {
    "target": "ESNext",
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "noEmit": true,
    "esModuleInterop": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "strict": true,
    "skipLibCheck": true,
    "paths": {
      "@": ["../src"],
      "@/*": ["../src/*"],
      "~": ["../src"],
      "~/*": ["../src/*"],
      "@@": [".."],
      "@@/*": ["../*"],
      "~~": [".."],
      "~~/*": ["../*"]
    }
  },
  "include": [
    "../**/*",
    "./wxt.d.ts"
  ],
  "exclude": ["../.output"]
}
```

### .wxt\types\globals.d.ts

```typescript
// .wxt\types\globals.d.ts
// Generated by wxt
interface ImportMetaEnv {
  readonly MANIFEST_VERSION: 2 | 3;
  readonly BROWSER: string;
  readonly CHROME: boolean;
  readonly FIREFOX: boolean;
  readonly SAFARI: boolean;
  readonly EDGE: boolean;
  readonly OPERA: boolean;
  readonly COMMAND: "build" | "serve";
  readonly ENTRYPOINT: string;
}
interface ImportMeta {
  readonly env: ImportMetaEnv
}

```

### .wxt\types\i18n.d.ts

```typescript
// .wxt\types\i18n.d.ts
// Generated by wxt
import "wxt/browser";

declare module "wxt/browser" {
  /**
   * See https://developer.chrome.com/docs/extensions/reference/i18n/#method-getMessage
   */
  interface GetMessageOptions {
    /**
     * See https://developer.chrome.com/docs/extensions/reference/i18n/#method-getMessage
     */
    escapeLt?: boolean
  }

  export interface WxtI18n extends I18n.Static {
    /**
     * The extension or app ID; you might use this string to construct URLs for resources inside the extension. Even unlocalized extensions can use this message.
     * Note: You can't use this message in a manifest file.
     *
     * "<browser.runtime.id>"
     */
    getMessage(
      messageName: "@@extension_id",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    /**
     * "<browser.i18n.getUiLocale()>"
     */
    getMessage(
      messageName: "@@ui_locale",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    /**
     * The text direction for the current locale, either "ltr" for left-to-right languages such as English or "rtl" for right-to-left languages such as Japanese.
     *
     * "<ltr|rtl>"
     */
    getMessage(
      messageName: "@@bidi_dir",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    /**
     * If the @@bidi_dir is "ltr", then this is "rtl"; otherwise, it's "ltr".
     *
     * "<rtl|ltr>"
     */
    getMessage(
      messageName: "@@bidi_reversed_dir",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    /**
     * If the @@bidi_dir is "ltr", then this is "left"; otherwise, it's "right".
     *
     * "<left|right>"
     */
    getMessage(
      messageName: "@@bidi_start_edge",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    /**
     * If the @@bidi_dir is "ltr", then this is "right"; otherwise, it's "left".
     *
     * "<right|left>"
     */
    getMessage(
      messageName: "@@bidi_end_edge",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
    getMessage(
      messageName: "@@extension_id" | "@@ui_locale" | "@@bidi_dir" | "@@bidi_reversed_dir" | "@@bidi_start_edge" | "@@bidi_end_edge",
      substitutions?: string | string[],
      options?: GetMessageOptions,
    ): string;
  }
}

```

### .wxt\types\imports-module.d.ts

```typescript
// .wxt\types\imports-module.d.ts
// Generated by wxt
// Types for the #import virtual module
declare module '#imports' {
  export { browser, Browser } from 'wxt/browser';
  export { storage, StorageArea, WxtStorage, WxtStorageItem, StorageItemKey, StorageAreaChanges, MigrationError } from 'wxt/utils/storage';
  export { useAppConfig } from 'wxt/utils/app-config';
  export { ContentScriptContext, WxtWindowEventMap } from 'wxt/utils/content-script-context';
  export { createIframeUi, IframeContentScriptUi, IframeContentScriptUiOptions } from 'wxt/utils/content-script-ui/iframe';
  export { createIntegratedUi, IntegratedContentScriptUi, IntegratedContentScriptUiOptions } from 'wxt/utils/content-script-ui/integrated';
  export { createShadowRootUi, ShadowRootContentScriptUi, ShadowRootContentScriptUiOptions } from 'wxt/utils/content-script-ui/shadow-root';
  export { ContentScriptUi, ContentScriptUiOptions, ContentScriptOverlayAlignment, ContentScriptAppendMode, ContentScriptInlinePositioningOptions, ContentScriptOverlayPositioningOptions, ContentScriptModalPositioningOptions, ContentScriptPositioningOptions, ContentScriptAnchoredOptions, AutoMountOptions, StopAutoMount, AutoMount } from 'wxt/utils/content-script-ui/types';
  export { defineAppConfig, WxtAppConfig } from 'wxt/utils/define-app-config';
  export { defineBackground } from 'wxt/utils/define-background';
  export { defineContentScript } from 'wxt/utils/define-content-script';
  export { defineUnlistedScript } from 'wxt/utils/define-unlisted-script';
  export { defineWxtPlugin } from 'wxt/utils/define-wxt-plugin';
  export { injectScript, ScriptPublicPath, InjectScriptOptions } from 'wxt/utils/inject-script';
  export { InvalidMatchPattern, MatchPattern } from 'wxt/utils/match-patterns';
  export { onMount, beforeUpdate, afterUpdate, onDestroy, tick, setContext, getContext, hasContext, getAllContexts, createEventDispatcher } from 'svelte';
  export { fakeBrowser } from 'wxt/testing';
}

```

### .wxt\types\imports.d.ts

```typescript
// .wxt\types\imports.d.ts
// Generated by wxt
export {}
declare global {
  const ContentScriptContext: typeof import('wxt/utils/content-script-context')['ContentScriptContext']
  const InvalidMatchPattern: typeof import('wxt/utils/match-patterns')['InvalidMatchPattern']
  const MatchPattern: typeof import('wxt/utils/match-patterns')['MatchPattern']
  const afterUpdate: typeof import('svelte')['afterUpdate']
  const beforeUpdate: typeof import('svelte')['beforeUpdate']
  const browser: typeof import('wxt/browser')['browser']
  const createEventDispatcher: typeof import('svelte')['createEventDispatcher']
  const createIframeUi: typeof import('wxt/utils/content-script-ui/iframe')['createIframeUi']
  const createIntegratedUi: typeof import('wxt/utils/content-script-ui/integrated')['createIntegratedUi']
  const createShadowRootUi: typeof import('wxt/utils/content-script-ui/shadow-root')['createShadowRootUi']
  const defineAppConfig: typeof import('wxt/utils/define-app-config')['defineAppConfig']
  const defineBackground: typeof import('wxt/utils/define-background')['defineBackground']
  const defineContentScript: typeof import('wxt/utils/define-content-script')['defineContentScript']
  const defineUnlistedScript: typeof import('wxt/utils/define-unlisted-script')['defineUnlistedScript']
  const defineWxtPlugin: typeof import('wxt/utils/define-wxt-plugin')['defineWxtPlugin']
  const fakeBrowser: typeof import('wxt/testing')['fakeBrowser']
  const getAllContexts: typeof import('svelte')['getAllContexts']
  const getContext: typeof import('svelte')['getContext']
  const hasContext: typeof import('svelte')['hasContext']
  const injectScript: typeof import('wxt/utils/inject-script')['injectScript']
  const onDestroy: typeof import('svelte')['onDestroy']
  const onMount: typeof import('svelte')['onMount']
  const setContext: typeof import('svelte')['setContext']
  const storage: typeof import('wxt/utils/storage')['storage']
  const tick: typeof import('svelte')['tick']
  const useAppConfig: typeof import('wxt/utils/app-config')['useAppConfig']
}
// for type re-export
declare global {
  // @ts-ignore
  export type { Browser } from 'wxt/browser'
  import('wxt/browser')
  // @ts-ignore
  export type { StorageArea, WxtStorage, WxtStorageItem, StorageItemKey, StorageAreaChanges, MigrationError } from 'wxt/utils/storage'
  import('wxt/utils/storage')
  // @ts-ignore
  export type { WxtWindowEventMap } from 'wxt/utils/content-script-context'
  import('wxt/utils/content-script-context')
  // @ts-ignore
  export type { IframeContentScriptUi, IframeContentScriptUiOptions } from 'wxt/utils/content-script-ui/iframe'
  import('wxt/utils/content-script-ui/iframe')
  // @ts-ignore
  export type { IntegratedContentScriptUi, IntegratedContentScriptUiOptions } from 'wxt/utils/content-script-ui/integrated'
  import('wxt/utils/content-script-ui/integrated')
  // @ts-ignore
  export type { ShadowRootContentScriptUi, ShadowRootContentScriptUiOptions } from 'wxt/utils/content-script-ui/shadow-root'
  import('wxt/utils/content-script-ui/shadow-root')
  // @ts-ignore
  export type { ContentScriptUi, ContentScriptUiOptions, ContentScriptOverlayAlignment, ContentScriptAppendMode, ContentScriptInlinePositioningOptions, ContentScriptOverlayPositioningOptions, ContentScriptModalPositioningOptions, ContentScriptPositioningOptions, ContentScriptAnchoredOptions, AutoMountOptions, StopAutoMount, AutoMount } from 'wxt/utils/content-script-ui/types'
  import('wxt/utils/content-script-ui/types')
  // @ts-ignore
  export type { WxtAppConfig } from 'wxt/utils/define-app-config'
  import('wxt/utils/define-app-config')
  // @ts-ignore
  export type { ScriptPublicPath, InjectScriptOptions } from 'wxt/utils/inject-script'
  import('wxt/utils/inject-script')
}

```

### .wxt\types\paths.d.ts

```typescript
// .wxt\types\paths.d.ts
// Generated by wxt
import "wxt/browser";

declare module "wxt/browser" {
  export type PublicPath =
    | ""
    | "/"
    | "/background.js"
    | "/content-scripts/content.js"
    | "/icon/128.png"
    | "/icon/16.png"
    | "/icon/32.png"
    | "/icon/48.png"
    | "/icon/96.png"
    | "/popup.html"
    | "/wxt.svg"
  type HtmlPublicPath = Extract<PublicPath, `${string}.html`>
  export interface WxtRuntime {
    getURL(path: PublicPath): string;
    getURL(path: `${HtmlPublicPath}${string}`): string;
  }
}

```

### .wxt\wxt.d.ts

```typescript
// .wxt\wxt.d.ts
// Generated by wxt
/// <reference types="wxt/vite-builder-env" />
/// <reference types="@wxt-dev/module-svelte" />
/// <reference path="./types/paths.d.ts" />
/// <reference path="./types/i18n.d.ts" />
/// <reference path="./types/globals.d.ts" />
/// <reference path="./types/imports-module.d.ts" />
/// <reference path="./types/imports.d.ts" />

```

### explain.md

```markdown
// explain.md

```

### index.html

```html
// index.html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Emit events</h1>

    <script>
      let counter = 0;
      setInterval(() => {
        document.dispatchEvent(
          new CustomEvent("counter:updated", {
            detail: {
              counter: counter++,
            },
          })
        );
      }, 1000);
    </script>
  </body>
</html>

```

### package.json

```json
// package.json
{
  "name": "svelte-state-rune",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "wxt",
    "dev:firefox": "wxt -b firefox",
    "build": "wxt build",
    "build:firefox": "wxt build -b firefox",
    "zip": "wxt zip",
    "zip:firefox": "wxt zip -b firefox",
    "check": "svelte-check --tsconfig ./tsconfig.json",
    "postinstall": "wxt prepare"
  },
  "devDependencies": {
    "@tsconfig/svelte": "^5.0.4",
    "@wxt-dev/module-svelte": "^2.0.3",
    "svelte": "^5.28.2",
    "svelte-check": "^4.1.6",
    "tslib": "^2.7.0",
    "typescript": "^5.8.2",
    "vite": "6.3.3",
    "wxt": "^0.20.5"
  }
}

```

### README.md

```markdown
// README.md
---
name: Svelte State Rune
description: A uses a state rune with WXT's storage to enable clean subscriptions in Svelte (and TS) as well as persisting state.
---

```sh
npm install
npm run dev
```

Demonstrates how the browser.storage API allows different parts of the extension share state and reflect activity on the current page.

- The page fires a "counter:updated" event every second.
- The Content Script handles these events by pushing the event payload into session storage.
- The CounterState class watches the store and updates its reactive state property on change
- App.svelte reflects the value of `counterState.state`

Open dev tools or the extension service worker logs, click the extension's action icon and watch the events being fired by the active page update the counter.

When closing and re-opening the Popup, the state is persisted.

```

### src\entrypoints\background.ts

```typescript
// src\entrypoints\background.ts
export default defineBackground(() => {
  // Set the access level so `browser.storage.session` is defined and availble
  // in content scripts: https://developer.chrome.com/docs/extensions/reference/api/storage#storage_areas
  void browser.storage.session.setAccessLevel?.({
    accessLevel: "TRUSTED_AND_UNTRUSTED_CONTEXTS",
  });
});

```

### src\entrypoints\content.ts

```typescript
// src\entrypoints\content.ts
import { counterStore } from "@/lib/counter-store";

export default defineContentScript({
  matches: ["http://localhost/*"],

  main() {
    document.addEventListener("counter:updated", (event) => {
      void counterStore.setValue(event.detail);
    });
  },
});

```

### src\entrypoints\popup\app.css

```css
// src\entrypoints\popup\app.css
:root {
  font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-text-size-adjust: 100%;
}

body {
  margin: 0;
  display: flex;
  place-items: center;
  min-width: 320px;
  min-height: 100vh;
}

.app {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;

  &:hover {
    filter: drop-shadow(0 0 2em #54bc4ae0);
  }

  &.svelte:hover {
    filter: drop-shadow(0 0 2em #ff3e00aa);
  }
}

.read-the-docs {
  color: #888;
}

.card {
  font-size: 2rem;
}

```

### src\entrypoints\popup\App.svelte

```plaintext
// src\entrypoints\popup\App.svelte
<script lang="ts">
  import svelteLogo from "../../assets/svelte.svg";
  import { counterState } from "@/lib/counter-state.svelte";
</script>

<main class="app">
  <div>
    <a href="https://wxt.dev" target="_blank" rel="noreferrer">
      <img src="/wxt.svg" class="logo" alt="WXT Logo" />
    </a>
    <a href="https://svelte.dev" target="_blank" rel="noreferrer">
      <img src={svelteLogo} class="logo svelte" alt="Svelte Logo" />
    </a>
  </div>
  <h1>WXT + Svelte</h1>

  <div class="card">
    <p>{counterState.state.counter}</p>
  </div>

  <p class="read-the-docs">Click on the WXT and Svelte logos to learn more</p>
</main>

```

### src\entrypoints\popup\index.html

```html
// src\entrypoints\popup\index.html
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Default Popup Title</title>
    <meta name="manifest.type" content="browser_action" />
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="./main.ts"></script>
  </body>
</html>

```

### src\entrypoints\popup\main.ts

```typescript
// src\entrypoints\popup\main.ts
import { mount } from "svelte";

import "./app.css";
import App from "./App.svelte";

const app = mount(App, {
  target: document.getElementById("app")!,
});

export default app;

```

### src\lib\counter-state.svelte.ts

```typescript
// src\lib\counter-state.svelte.ts
import { counterStore } from "./counter-store.ts";

class CounterState {
  state = $state(counterStore.fallback);

  constructor() {
    counterStore.getValue().then(this.updateCounter);
    counterStore.watch(this.updateCounter);
  }

  updateCounter = (newState: { counter: number } | null) => {
    this.state = newState ?? counterStore.fallback;
  };
}

export const counterState = new CounterState();

```

### src\lib\counter-store.ts

```typescript
// src\lib\counter-store.ts
export const counterStore = storage.defineItem<{ counter: number }>(
  "session:counter",
  {
    fallback: { counter: 0 }
  }
);

```

### src\typings\example.d.ts

```typescript
// src\typings\example.d.ts
export type CounterEvent = CustomEvent<{
  counter: number;
}>;

```

### src\typings\globals.ts

```typescript
// src\typings\globals.ts
import type { CounterEvent } from "./example.d.ts";

declare global {
  interface DocumentEventMap {
    "counter:updated": CounterEvent;
  }
}

```

### tsconfig.json

```json
// tsconfig.json
{
  "extends": "./.wxt/tsconfig.json",
  "compilerOptions": {
    "useDefineForClassFields": true,
    "allowImportingTsExtensions": true
  }
}

```

### wxt-env.d.ts

```typescript
// wxt-env.d.ts
/// <reference types="svelte" />

```

### wxt.config.ts

```typescript
// wxt.config.ts
import { defineConfig } from "wxt";

// See https://wxt.dev/api/config.html
export default defineConfig({
  srcDir: "src",
  modules: ["@wxt-dev/module-svelte"],
  manifest: {
    permissions: ["storage"],
  },
  webExt: {
    startUrls: ["http://localhost:3000"],
  },
});

```

